From 0f7376bd10c913c7e6b1e7e02dd5fd7769975d78 Mon Sep 17 00:00:00 2001
From: ginuerzh <ginuerzh@gmail.com>
Date: Sat, 4 Feb 2023 18:37:14 +0800
Subject: [PATCH] go1.22

---
 Dockerfile   |   2 +-
 README.md    |   2 +-
 README_en.md |   2 +-
 go.mod       |  32 ++++---
 go.sum       | 244 +++++++--------------------------------------------
 quic.go      |   2 +-
 6 files changed, 52 insertions(+), 232 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index 123456..789012 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,4 +1,4 @@
-FROM --platform=$BUILDPLATFORM golang:1.19-alpine as builder
+FROM --platform=$BUILDPLATFORM golang:1.22-alpine as builder

 # Convert TARGETPLATFORM to GOARCH format
 # https://github.com/tonistiigi/xx

diff --git a/README.md b/README.md
index abcdef..123456 100644
--- a/README.md
+++ b/README.md
@@ -195,7 +195,7 @@ gost -L=:8080 -F=h2://server_ip:443
 ```

 #### QUIC
-gost对QUIC的支持是基于[quic-go](https://github.com/lucas-clemente/quic-go)库。
+gost对QUIC的支持是基于[quic-go](https://github.com/quic-go/quic-go)库。

 服务端:
 ```bash

diff --git a/README_en.md b/README_en.md
index abcdef..123456 100644
--- a/README_en.md
+++ b/README_en.md
@@ -218,7 +218,7 @@ gost -L=:8080 -F=h2://server_ip:443

 #### QUIC

-Support for QUIC is based on library [quic-go](https://github.com/lucas-clemente/quic-go).
+Support for QUIC is based on library [quic-go](https://github.com/quic-go/quic-go).

 Server:

diff --git a/go.mod b/go.mod
index abcdef..123456 100644
--- a/go.mod
+++ b/go.mod

-go 1.18
+go 1.22

 replace github.com/templexxx/cpu v0.0.7 => github.com/templexxx/cpu v0.0.10-0.20211111114238-98168dcec14a

 require (
        filippo.io/edwards25519 v1.0.0-rc.1.0.20210721174708-390f27c3be20
        git.torproject.org/pluggable-transports/goptlib.git v1.3.0
        github.com/LiamHaworth/go-tproxy v0.0.0-20190726054950-ef7efd7f24ed
        github.com/asaskevich/govalidator v0.0.0-20230301143203-a9d515a09cc2
        github.com/go-gost/gosocks4 v0.0.1
        github.com/go-gost/gosocks5 v0.3.0
        github.com/go-gost/relay v0.1.1-0.20211123134818-8ef7fd81ffd7
        github.com/go-gost/tls-dissector v0.0.2-0.20220408131628-aac992c27451
        github.com/go-log/log v0.2.0
        github.com/gobwas/glob v0.2.3
-       github.com/gorilla/websocket v1.4.2
-       github.com/klauspost/compress v1.13.6
-       github.com/lucas-clemente/quic-go v0.28.1
-       github.com/miekg/dns v1.1.47
+       github.com/gorilla/websocket v1.5.1
+       github.com/klauspost/compress v1.17.6
+       github.com/quic-go/quic-go v0.45.0
+       github.com/miekg/dns v1.1.58
        github.com/ryanuber/go-glob v1.0.0
        github.com/shadowsocks/go-shadowsocks2 v0.1.5
        github.com/shadowsocks/shadowsocks-go v0.0.0-20200409064450-3e585ff90601
        github.com/songgao/water v0.0.0-20200317203138-2b4b6d7c09d8
-       github.com/xtaci/kcp-go/v5 v5.6.1
-       github.com/xtaci/smux v1.5.16
+       github.com/xtaci/kcp-go/v5 v5.6.7
+       github.com/xtaci/smux v1.5.24
        github.com/xtaci/tcpraw v1.2.25
        gitlab.com/yawning/obfs4.git v0.0.0-20220204003609-77af0cba934d
-       golang.org/x/crypto v0.0.0-20220817201139-bc19a97f63c8
-       golang.org/x/net v0.0.0-20220812174116-3211cb980234
+       golang.org/x/crypto v0.24.0
+       golang.org/x/net v0.26.0
+       golang.org/x/sys v0.21.0
+       golang.org/x/tools v0.22.0
+       golang.org/x/sync v0.7.0
+       golang.org/x/exp v0.0.0-20240604190554-fc45aab8b7f8
+       golang.org/x/mod v0.18.0
+       golang.org/x/text v0.16.0
+       golang.org/x/term v0.21.0
+       golang.org/x/time v0.5.0
 )

 require (
        github.com/aead/chacha20 v0.0.0-20180709150244-8b13a72661da
-       github.com/cheekybits/genny v1.0.0
        github.com/coreos/go-iptables v0.6.0
        github.com/dchest/siphash v1.2.2
-       github.com/fsnotify/fsnotify v1.5.4
-       github.com/go-task/slim-sprig v0.0.0-20210107165309-348f09dbbbc0
+       github.com/go-task/slim-sprig/v3 v3.0.0
+       github.com/go-logr/logr v1.4.1
+       github.com/google/go-cmp v0.6.0
        github.com/google/gopacket v1.1.19
-       github.com/google/pprof v0.0.0-20230131232505-5a9e8f65f08f
-       github.com/klauspost/cpuid/v2 v2.0.9
-       github.com/klauspost/reedsolomon v1.9.15
-       github.com/marten-seemann/qtls-go1-16 v0.1.5
-       github.com/marten-seemann/qtls-go1-17 v0.1.2
-       github.com/marten-seemann/qtls-go1-18 v0.1.2
-       github.com/marten-seemann/qtls-go1-19 v0.1.0
-       github.com/nxadm/tail v1.4.8
-       github.com/onsi/ginkgo v1.16.5
+       github.com/google/pprof v0.0.0-20240528025155-186aa0362fba
+       github.com/klauspost/cpuid/v2 v2.2.6
+       github.com/klauspost/reedsolomon v1.12.0
+       github.com/onsi/ginkgo/v2 v2.19.0
+       github.com/onsi/gomega v1.33.1
        github.com/pkg/errors v0.9.1
+       github.com/stretchr/testify v1.8.4
+       github.com/davecgh/go-spew v1.1.1
+       github.com/pmezard/go-difflib v1.0.0
+       gopkg.in/yaml.v3 v3.0.1
+       google.golang.org/protobuf v1.33.0
+       go.uber.org/mock v0.4.0
        github.com/riobard/go-bloom v0.0.0-20200614022211-cdc8013cb5b3
-       github.com/templexxx/cpu v0.0.7
-       github.com/templexxx/xorsimd v0.4.1
+       github.com/templexxx/cpu v0.1.0
+       github.com/templexxx/xorsimd v0.4.2
        github.com/tjfoc/gmsm v1.4.1
        github.com/xtaci/lossyconn v0.0.0-20200209145036-adba10fffc37
-       golang.org/x/sys v0.0.0-20220817070843-5a390386f1f2
 )

diff --git a/quic.go b/quic.go
index abcdef..123456 100644
--- a/quic.go
+++ b/quic.go
@@ -13,7 +13,7 @@ import (
        "time"

        "github.com/go-log/log"
-       quic "github.com/lucas-clemente/quic-go"
+       quic "github.com/quic-go/quic-go"
 )

 type quicSession struct {
